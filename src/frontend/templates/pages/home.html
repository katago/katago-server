{% extends 'base.html' %}

{% load i18n %}
{% load custom_translation %}

{% block extra_html_head_stuff %}
<script src="https://d3js.org/d3.v4.js"></script>
<script>
</script>
{% endblock extra_html_head_stuff %}

{% block title %}{% trans "KataGo Distributed Training" %}{% endblock %}

{% block content %}

<h1 class="title">{% trans "KataGo Distributed Training" %}</h1>

<h2 class="is-size-2"> {% trans "How to Contribute" %} </h2>

TODO :)

<h2 class="is-size-2"> {% trans "Stats" %} </h2>

<h3 class="is-size-3"> {% trans "Data" %} </h3>

{% blocktrans %}
<p>
In total, users have uploaded {{ total_num_training_rows }} rows of training data and {{ total_num_games }} games so far.
<p>
Within the last week, a total {{ num_recent_contributors }} different users uploaded
{{ num_recent_training_rows }} rows of training data and {{ num_recent_games }} new games.
{% endblocktrans %}

<h5 class="is-size-5"> {% trans "Top contributors in the last week:" %} </h5>

<table class="table">
  <tr>
    <th> {% trans "User" %} </th>
    <th class="has-text-right"> {% trans "Training Rows Generated" %} </th>
    <th class="has-text-right"> {% trans "Training Games" %} </th>
    <th class="has-text-right"> {% trans "Rating Games" %} </th>
  </tr>
  {% for user in top_recent_user_list %}
  <tr>
    <td> {{ user.username }} </td>
    <td class="has-text-right"> {{ user.total_num_training_rows|as_n_training_rows_str }} </td>
    <td class="has-text-right"> {{ user.total_num_training_games|as_n_training_games_str }} </td>
    <td class="has-text-right"> {{ user.total_num_rating_games|as_n_rating_games_str }} </td>
  </tr>
  {% endfor %}
</table>

{% if run %}

<h3 class="is-size-3"> {% trans "Networks" %} </h3>

{% blocktrans %}
A total of {{ num_networks_this_run_excluding_random }} networks have
been produced for the current run.
{% endblocktrans %}

<p>
{% if latest_network %}

{% url 'current_run_networks' as current_run_networks %}
{% blocktrans with latest_network_url=latest_network.model_file.url networks_url=url %}
Download the latest network <a href="{{ latest_network_url }}">here!</a>
<p>
See <a href="{{ current_run_networks }}">Networks page</a> for older networks.
{% endblocktrans %}

{% endif %}

<h5 class="is-size-5"> {% trans "Approximate Elo ratings" %} </h3>

{% blocktrans %}
Approximate Elo ratings of networks this run based on low numbers of playouts (mid-to-high-hundreds), based on {{ num_rating_games_this_run }} rating games,
relative to 0 = random:
{% endblocktrans %}

<div id="eloGraph"></div>
{% endif %}

{% endblock content %}
